(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"2bc822e570489344a484":function(e,t,r){"use strict";r.r(t);var n=r("8af190b70a6bc55c6f1b"),a=r.n(n),o=(r("8a2d1b95e05b6a321e74"),r("0b3cb19af78752326f59")),i=r("ef55fb2ebc45364e784e"),l=r("c1d0df1466113eca96ac"),s=r("c9dd7b4f2540bc3f4075"),c=r("9cbbf93b4b14a35c4c9d"),f=r("820838b578959fb7cbd0"),u=r("a17698738bfaaefd79fe"),p=r("02529214ba6eaf3d0120");function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var g={atk:!0,spd:!0,def:!0,res:!0},b=function(e,t){return{weapon:i.a.getSkill(e.weapon,t),assist:l.a.getSkill(e.assist),special:s.a.getSkill(e.special),skillA:c.a.getSkill(e.skillA),skillB:f.a.getSkill(e.skillB),skillC:u.a.getSkill(e.skillC),seal:p.a.getSkill(e.seal)}};function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w=function(e){if("-"===e)return{boon:"hp",bane:"hp"};var t=e.substring(1).split("-");return{boon:t[0],bane:t[1]}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hp:0,atk:0,spd:0,def:0,res:0},t=arguments.length>1?arguments[1]:void 0,r=w(t),n=r.boon,a=r.bane,o={hp:0,atk:0,spd:0,def:0,res:0};return o[n]+=1,o[a]-=1,Object.entries(e).reduce((function(e,t){var r=h(t,2),n=r[0];return y({},e,m({},n,r[1]+o[n]))}),{})},O=r("6080a705f759d5ca199c");function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function S(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var P=function(e,t,r,n,a,o,i,l,s,c){var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hp:0,atk:0,spd:0,def:0,res:0},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=Array.isArray(e.hp),a=w(t),o=a.boon,i=a.bane,l={hp:1,atk:1,spd:1,def:1,res:1};l[o]+=1,l[i]-=1;var s=Object.entries(e).reduce((function(e,t){var r,a=h(t,2),o=a[0],i=a[1],s=n?i[l[o]]:i;return y({},e,(m(r={},o,s),m(r,"bst",e.bst+s),r))}),{bst:0});return r>0&&(n?(s[i]=e[i][1],s.bst+=o===i?3:e[i][1]-e[i][0]):(s[i]=e[i],s.bst+=3)),s}(t["".concat(e)],r,n),u=f.bst,p=S(f,["bst"]),d=k(t["".concat(e,"-1")],r),g=k(t["5-1"],r),b=Object(O.a)(g,n,"-"===r),v=function(e,t){var r=Object.entries(e).map((function(e){var t=x(e,2);return{key:t[0],stat:t[1]}}));r.sort((function(e,t){return e.stat>t.stat?-1:e.stat<t.stat?1:e.index<t.index?-1:e.index>t.index?1:0}));for(var n=r.map((function(e){return e.key})),a={hp:0,atk:0,spd:0,def:0,res:0},o=0;o<t;o+=1)a[n[o%5]]+=1;return a}(g,s),P=a?{hp:5,atk:2,spd:2,def:2,res:2}:{hp:0,atk:0,spd:0,def:0,res:0},C=l?{hp:10,atk:4,spd:4,def:4,res:4}:{hp:0,atk:0,spd:0,def:0,res:0},T=c?2:0;return{stats:Object.entries(i?d:p).reduce((function(e,t){var r=I(t,2),n=r[0],a=r[1]+o.stats[n]+b[n]+v[n]+P[n]+C[n]+T;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,A({},n,a>-1?a:0))}),{}),bst:u}},C={1:{base:47,float:69},2:{base:49,float:74},3:{base:51,float:81},4:{base:53,float:86},5:{base:55,float:93}},T=function(e){var t=e.rarity,r=void 0===t?5:t,n=e.merge,a=e.bst,o=e.spt,i=e.blesser,l=void 0===i?0:i,s=C[r];return 2*(150+s.base+s.float+2*n+Math.floor(a/5)+Math.floor(o/100)+4*l)};function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var D,B=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageData=new Image,this.src="",this.loadedData=!1,this.callback=t,this.imageData.onload=function(){r.loadedData=!0,r.callback(!0)},this.imageData.onerror=function(){r.loadedData=!1,r.callback(!1)}}var t,r,n;return t=e,(r=[{key:"load",value:function(e){e!==this.src&&(this.loadedData=!1,this.src=e,this.imageData.src=e)}},{key:"loaded",get:function(){return this.loadedData}},{key:"image",get:function(){return this.imageData}}])&&E(t.prototype,r),n&&E(t,n),e}(),M=r("6ceadaea642dceea7a37");function H(e,t,r,n){D||(D="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var a=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var i=new Array(o),l=0;l<o;l++)i[l]=arguments[l+3];t.children=i}if(t&&a)for(var s in a)void 0===t[s]&&(t[s]=a[s]);else t||(t=a||{});return{$$typeof:D,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var N,R=H("path",{d:"M38 18h-8v-12h-12v12h-8l14 14 14-14zm-28 18v4h28v-4h-28z"}),z=H("path",{d:"M0 0h48v48h-48z",fill:"none"}),J=function(e){return a.a.createElement("svg",_({xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48"},e),R,z)};function U(e,t,r,n){N||(N="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var a=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var i=new Array(o),l=0;l<o;l++)i[l]=arguments[l+3];t.children=i}if(t&&a)for(var s in a)void 0===t[s]&&(t[s]=a[s]);else t||(t=a||{});return{$$typeof:N,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var V=U("path",{d:"M0 0h24v24H0z",fill:"none"}),F=U("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),W=function(e){return a.a.createElement("svg",$({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},e),V,F)},Y=16,L=554,q=i.c,G=174,K=555,Q=["infantry","armored","cavalry","flying"];function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ee=1,te=43,re=85,ne=127,ae=169,oe=[0,1,2,3,4,5,6,7,8,9,"x","+","-"].reduce((function(e,t,r){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){Z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,Z({},t,34*r+1))}),{}),ie=function(e,t,r,n,a,o){oe[n]&&e.drawImage(t,oe[n],r,32,40,a,o,16,20)},le=240,se=557,ce=[14,28,42],fe=["infantry","armored","cavalry","flying"],ue=432,pe=425,de=432,ge=425,be=275,ve=594,ye=function(e,t,r){var n=37*r+1+ve;e.drawImage(t,be,n,35,35)},me=82,he=557,we=[14,28,42],ke=112,Oe=557,xe=[14,28,42],je=130,Ae=594,Ie=[14,28,42,56],Se=[1e3,100,10],Pe=function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ee,o=8+Ae+37*n;Se.forEach((function(n,i){if(r>=n){var l=Math.floor(r/n%10);ie(e,t,a,l,je+Ie[i],o)}}));var i=r%10;ie(e,t,a,i,je+Ie[3],o)},Ce=465,Te=594,Ee=function(e){var t=e.context,r=e.numberAtlas,n=e.accelerate,a=e.specialCD;if(a){var o=te;n<0&&(o=re),n>0&&(o=ne),function(e,t,r){ie(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:te,r,Ce,8+Te+74)}(t,r,n+a,o)}};function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Be=206,Me=1224,He=["#ffa0af","white","#aaf0fa"],_e=Object.entries({hp:"HP",atk:"\u653b\u64ca",spd:"\u901f\u5ea6",def:"\u9632\u5b88",res:"\u9b54\u9632",bst:"BST",arena:"\u9b25\u6280\u5206"});function Ne(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Re,ze=634,Je=1224,Ue={weapon:0,assist:1,special:2,skillA:3,skillB:4,skillC:5,seal:6},$e=296,Ve=876,Fe=336,We=992,Ye=24,Le=195,qe=370;function Ge(e){return(Ge="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t,r,n){Re||(Re="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var a=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var i=new Array(o),l=0;l<o;l++)i[l]=arguments[l+3];t.children=i}if(t&&a)for(var s in a)void 0===t[s]&&(t[s]=a[s]);else t||(t=a||{});return{$$typeof:Re,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){nt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var at=o.d.canvas.withConfig({displayName:"UnitViewer__Canvas",componentId:"sc-15sy0br-0"})(["max-width:100vw;max-height:100vh;position:relative;"]),ot=o.d.div.withConfig({displayName:"UnitViewer__Container",componentId:"sc-15sy0br-1"})(["width:auto;max-width:100vw;position:relative;display:flex;justify-content:center;"]),it=Object(o.c)(["background-color:white;color:black;position:absolute;border-radius:1.25em;padding:0.5em;font-size:16px;width:2.5em;height:2.5em;cursor:pointer;box-sizing:border-box;"]),lt=Object(o.d)(J).withConfig({displayName:"UnitViewer__DownloadButton",componentId:"sc-15sy0br-2"})(["top:4px;right:4px;",";@media screen and (max-width:1024px){top:calc(12px + 2.5em);}"],it),st=Object(o.d)(W).withConfig({displayName:"UnitViewer__MenuButton",componentId:"sc-15sy0br-3"})(["top:4px;right:4px;",";@media screen and (min-width:1025px){display:none;pointer-events:none;}"],it),ct=function(e){function t(e){var r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=et(t).call(this,e),r=!o||"object"!==Ge(o)&&"function"!==typeof o?tt(n):o,nt(tt(r),"updateCanvas",(function(){var e=r.props,t=e.hero,n=e.rarity,a=e.iv,o=e.merge,i=e.support,l=e.weapon,s=e.refine,c=e.assist,f=e.special,u=e.skillA,p=e.skillB,g=e.skillC,v=e.seal,y=e.lv1,m=e.arena,h=e.dragonflower,w=e.resplendent,k={weapon:l,assist:c,special:f,skillA:u,skillB:p,skillC:g,seal:v},O=t.get("bst",0),x=t.get("stats").toJS(),j=function(e,t,r,n){var a=b(e,t),o={},i=0,l=a.special.get("cd",0);i+=a.weapon.get("cd",0),i+=a.assist.get("cd",0),i+=a.skillA.get("cd",0),i+=a.skillB.get("cd",0),i+=a.skillC.get("cd",0),i+=a.seal.get("cd",0);var s={hp:0,atk:0,spd:0,def:0,res:0},c=0,f=0;Object.entries(a).forEach((function(e){var t=d(e,2),r=t[0],a=t[1];o[r]=a.get("name","-"),s.hp+=a.get("hp",0),s.atk+=a.get("mt",0)+a.get("atk",0),s.spd+=a.get("spd",0),s.def+=a.get("def",0),s.res+=a.get("res",0),c+=a.get("sp",0),5===n&&(f=Math.max(a.get("bst",0),f))}));var u=a.weapon.getIn(["refine",r]);return u&&(s.hp+=u.get("hp",0),s.atk+=u.get("mt",0)+u.get("atk",0),s.spd+=u.get("spd",0),s.def+=u.get("def",0),s.res+=u.get("res",0),i+=u.get("cd",0),a.weapon.has("exclusive")||(c+=50),5===n&&(f=Math.max(f,u.get("bst",0)))),{names:o,stats:s,accelerate:i,specialCD:l,spt:c,bst:f}}(k,t,s,n),A=P(n,x,a,o,i,j,y,m,h,w);r.skillInfos=j,r.statsInfos=A,r.score=T({rarity:n,merge:o,bst:Math.max(A.bst,j.bst,O),spt:j.spt}),r.draw(),r.setAssets()})),nt(tt(r),"setAssets",(function(){var e=r.props,t=e.hero,n=e.blessing,a=e.weapon,o=e.refine,i=e.assist,l=e.special,s=e.skillA,c=e.skillB,f=e.skillC,u=e.seal,p=e.resplendent,v=Object(M.a)(t.get("id"),p),y={weapon:a,assist:i,special:l,skillA:s,skillB:c,skillC:f,seal:u};r.loaders.portrait.load("portraits/".concat(v,".png"));var m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",n=b(e,t),a={};if(Object.entries(n).forEach((function(e){var t=d(e,2),r=t[0],n=t[1].get("icon",null);a[r]=n&&"skills/".concat(n)})),"-"!==r){var o=n.weapon.getIn(["refine",r,"icon"],null);a.weapon=g[r]?"skills/weapon/".concat(r,".png"):o&&"skills/weapon/".concat(o,".png")}return a}(y,t,o);[{skillName:"weapon",empty:"skills/weapon.png"},{skillName:"skillA",empty:"skills/empty.png"},{skillName:"skillB",empty:"skills/empty.png"},{skillName:"skillC",empty:"skills/empty.png"},{skillName:"seal",empty:"skills/seal-empty.png"}].forEach((function(e){var t=e.skillName,n=e.empty;r.loaders["".concat(t,"Icon")].load(m[t]||n)}));var h=n&&"-"!==n;r.loaders.blessingAtlas.load(h?"assets/blessing-".concat(n,".png"):"")})),nt(tt(r),"draw",(function(){var e=r.props,t=e.hero,n=e.rarity,a=e.iv,o=e.merge,i=e.blessing,l=e.support,s=e.refine,c=e.lv1,f=e.arena,u=e.dragonflower,p=e.resplendent,d=r.loaders,g=d.background,b=d.foreground,v=d.foreground2,y=d.portrait,m=d.rarityAtlas,h=d.weaponTypeAtlas,k=d.moveTypeAtlas,O=d.dragonflowerAtlas,x=d.supportAtlas,j=d.blessingAtlas,A=d.numberAtlas,I=d.weaponIcon,S=d.assistIcon,P=d.specialIcon,C=d.textA,T=d.textB,E=d.textC,D=d.textS,B=d.arenaIcon,M=d.skillAIcon,H=d.skillBIcon,_=d.skillCIcon,N=d.sealIcon,R=d.resplendentIcon,z=t.get("title"),J=t.get("name"),U=t.get("weaponType"),$=t.get("moveType"),V=i&&"-"!==i;if(r.canvasRef&&r.canvasRef.current){var F=r.canvasRef.current.getContext("2d");F.clearRect(0,0,540,960),g.loaded&&function(e){var t=e.context,r=e.background;e.support?t.drawImage(r,540,0,540,960,0,0,540,960):t.drawImage(r,0,0,540,960,0,0,540,960)}({context:F,background:g.image,support:l}),y.loaded&&function(e){var t=e.context,r=e.portrait;t.drawImage(r,0,0,540,960,0,0,540,960)}({context:F,portrait:y.image}),b.loaded&&function(e){var t=e.context,r=e.foreground;t.drawImage(r,0,0,540,960,0,0,540,960)}({context:F,foreground:b.image}),v.loaded&&function(e){var t=e.context,r=e.foreground2;e.dragonflower?t.drawImage(r,0,50,540,50,0,542,540,50):t.drawImage(r,0,0,540,50,0,542,540,50)}({context:F,foreground2:v.image,dragonflower:u}),m.loaded&&function(e){var t=e.context,r=e.rarityAtlas;switch(e.rarity){case 5:t.drawImage(r,0,0,153,40,42,380,153,40);break;case 4:t.drawImage(r,0,41,153,40,42,380,153,40)}}({context:F,rarityAtlas:m.image,rarity:n}),h.loaded&&function(e){var t=e.context,r=e.weaponTypeAtlas,n=e.weaponType,a=q.indexOf(n);a>-1&&t.drawImage(r,56*a,0,56,55,Y,L,28,28)}({context:F,weaponTypeAtlas:h.image,weaponType:U}),k.loaded&&function(e){var t=e.context,r=e.moveTypeAtlas,n=e.moveType,a=Q.indexOf(n);a>-1&&t.drawImage(r,56*a,0,52,52,G,K,26,26)}({context:F,moveTypeAtlas:k.image,moveType:$}),O.loaded&&A.loaded&&function(e){var t=e.context,r=e.dragonflowerAtlas,n=e.numberAtlas,a=e.moveType,o=e.dragonflower;if(o){var i=fe.indexOf(a);i>-1&&t.drawImage(r,0,58*i,64,58,216,546,48,44);var l=0,s=te;ie(t,n,s,"+",le+ce[0],se),l+=1,o>9&&(ie(t,n,s,1,le+ce[l],se),l+=1),ie(t,n,s,o%10,le+ce[l],se)}}({context:F,dragonflowerAtlas:O.image,numberAtlas:A.image,moveType:$,dragonflower:u}),x.loaded&&function(e){var t=e.context,r=e.supportAtlas,n=e.support,a=e.hasBlessing?108:0;n&&t.drawImage(r,ue-a,pe,108,115)}({context:F,supportAtlas:x.image,support:l,hasBlessing:V}),j.loaded&&function(e){var t=e.context,r=e.blessingAtlas;t.drawImage(r,de,ge,108,115)}({context:F,blessingAtlas:j.image,blessing:i}),A.loaded&&(!function(e){var t=e.context,r=e.numberAtlas,n=e.lv1?1:40,a=0;n>9&&ie(t,r,te,4,me+we[a],he),ie(t,r,te,n%10,me+we[a+=1],he)}({context:F,numberAtlas:A.image,lv1:c}),function(e){var t=e.context,r=e.numberAtlas,n=e.merge;if(!(n<=0)){var a=0,o=n>9?ae:te;ie(t,r,o,"+",ke+xe[0],Oe),a+=1,n>9&&(ie(t,r,o,1,ke+xe[a],Oe),a+=1),ie(t,r,o,n%10,ke+xe[a],Oe)}}({context:F,numberAtlas:A.image,merge:o}),function(e){var t=e.context,r=e.numberAtlas,n=e.stats,a=e.score,o=e.sbst,i=e.bst;Object.values(n).forEach((function(e,n){Pe(t,r,e,n,ee)}));var l=o>i?re:ae;Pe(t,r,i,5,ae),Pe(t,r,a,6,l)}(Xe({context:F,numberAtlas:A.image,score:r.score,sbst:Math.max(r.skillInfos.bst,t.get("bst",0))},r.statsInfos)),Ee({context:F,numberAtlas:A.image,accelerate:r.skillInfos.accelerate,specialCD:r.skillInfos.specialCD})),function(e){var t=e.context,r=e.weaponIcon,n=e.assistIcon,a=e.specialIcon,o=e.textA,i=e.textB,l=e.textC,s=e.textS,c=e.skillAIcon,f=e.skillBIcon,u=e.skillCIcon,p=e.sealIcon;r.loaded&&ye(t,r.image,0),n.loaded&&ye(t,n.image,1),a.loaded&&ye(t,a.image,2),c.loaded&&ye(t,c.image,3),t.drawImage(o.image,be+20,ve+112+18,18,18),f.loaded&&ye(t,f.image,4),t.drawImage(i.image,be+20,ve+149+18,18,18),u.loaded&&ye(t,u.image,5),t.drawImage(l.image,be+20,ve+186+18,18,18),p.loaded&&ye(t,p.image,6),t.drawImage(s.image,be+20,ve+223+18,18,18)}({context:F,weaponIcon:I,assistIcon:S,specialIcon:P,textA:C,textB:T,textC:E,textS:D,skillAIcon:M,skillBIcon:H,skillCIcon:_,sealIcon:N}),r.textCanvas.getContext("2d").clearRect(0,0,1080,1920),function(e){var t=e.canvas,r=e.iv,n=e.merge,a=t.getContext("2d");a.font="500 36px FEH, 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif",a.fillStyle="white",a.strokeStyle="#101010",a.textAlign="center",a.textBaseline="middle",a.lineJoin="round",a.lineWidth=8;var o=w(r),i=o.boon,l=o.bane,s={hp:1,atk:1,spd:1,def:1,res:1,bst:1,arena:1};s[i]+=1,s[l]-=1,s[l]=n>0?1:s[l],_e.forEach((function(e,t){var r=De(e,2),n=r[0],o=r[1],i=Me+74*t;a.fillStyle=He[s[n]],a.strokeText(o,Be,i),a.fillText(o,Be,i)}))}({canvas:r.textCanvas,iv:a,merge:o}),function(e){var t=e.canvas,r=e.refine,n=e.weapon,a=Ne(e,["canvas","refine","weapon"]),o=t.getContext("2d");o.font="500 36px FEH, 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif",o.textAlign="left",o.textBaseline="middle",o.lineJoin="round",o.lineWidth=8,o.strokeStyle="#101010",o.fillStyle="-"!==r?"lime":"white";var i=ze+("-"===n?4:0),l=Je;o.strokeText(n,i,l),o.fillText(n,i,l),o.fillStyle="white",Object.keys(a).forEach((function(e){var t=a[e],r=Je+74*Ue[e],n="-"===t?4:0;o.strokeText(t,ze+n,r),o.fillText(t,ze+n,r)}))}(Xe({canvas:r.textCanvas,refine:s},r.skillInfos.names)),function(e){var t=e.canvas,r=e.title,n=e.name,a=t.getContext("2d");a.font="500 48px FEH, 'Microsoft YaHei', 'Helvetica Neue', Helvetica, 'Microsoft JhengHei', Arial, sans-serif",a.fillStyle="white",a.strokeStyle="#220d00",a.textAlign="center",a.textBaseline="middle",a.lineJoin="round",a.lineWidth=8,a.strokeText(r,$e,Ve),a.fillText(r,$e,Ve),a.font="500 52px FEH, 'Microsoft YaHei', 'Helvetica Neue', Helvetica, 'Microsoft JhengHei', Arial, sans-serif",a.strokeText(n,Fe,We),a.fillText(n,Fe,We)}({canvas:r.textCanvas,title:z,name:J}),f&&B&&function(e){var t=e.context,r=e.arenaIcon;t.beginPath(),t.moveTo(28+Ye*Math.cos(0),28+Ye*Math.sin(0));for(var n=0;n<7;n+=1)t.lineTo(28+Ye*Math.cos(2*n*(Math.PI/6)),28+Ye*Math.sin(2*n*(Math.PI/6)));t.fillStyle="rgba(0, 0, 0, 0.63)",t.fill(),t.strokeStyle="rgba(255,255,255, 0.63)",t.lineWidth="2",t.stroke(),t.drawImage(r,12,12,32,32),t.closePath()}({context:F,arenaIcon:B.image}),p&&R&&function(e){var t=e.context,r=e.resplendentIcon;t.drawImage(r,Le,qe,64,63)}({context:F,resplendentIcon:R.image}),F.drawImage(r.textCanvas,0,0,540,960)}})),nt(tt(r),"download",(function(e){e.stopPropagation();var t=r.props.hero,n=r.canvasRef.current.toDataURL("image/png"),a=document.createElement("a");a.href=n,a.download="".concat(t.get("name"),"-").concat(t.get("title"),".png"),a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)})),r.canvasRef=a.a.createRef(),r.textCanvas=document.createElement("canvas"),r.textCanvas.width=1080,r.textCanvas.height=1920;r.loaders={};var i=function(){return r.draw()};return["background","foreground","foreground2","portrait","rarityAtlas","weaponTypeAtlas","moveTypeAtlas","dragonflowerAtlas","supportAtlas","blessingAtlas","numberAtlas","weaponIcon","assistIcon","specialIcon","textA","textB","textC","textS","arenaIcon","skillAIcon","skillBIcon","skillCIcon","sealIcon","resplendentIcon"].forEach((function(e){r.loaders[e]=new B(i)})),r.loaders.background.load("assets/background.jpg"),r.loaders.foreground.load("assets/foreground.png"),r.loaders.foreground2.load("assets/foreground2.png"),r.loaders.rarityAtlas.load("assets/rarity.png"),r.loaders.weaponTypeAtlas.load("assets/weapon-type.png"),r.loaders.moveTypeAtlas.load("assets/move-type.png"),r.loaders.dragonflowerAtlas.load("assets/dragonflower.png"),r.loaders.supportAtlas.load("assets/support.png"),r.loaders.numberAtlas.load("assets/number.png"),r.loaders.weaponIcon.load("skills/weapon.png"),r.loaders.assistIcon.load("skills/assist.png"),r.loaders.specialIcon.load("skills/special.png"),r.loaders.textA.load("assets/skill-a.png"),r.loaders.textB.load("assets/skill-b.png"),r.loaders.textC.load("assets/skill-c.png"),r.loaders.textS.load("assets/skill-s.png"),r.loaders.arenaIcon.load("assets/Dueling_Crest.png"),r.loaders.resplendentIcon.load("assets/god-wear-l.png"),r.updateCanvas(),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,e),r=t,(n=[{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"render",value:function(){return Ke(ot,{},void 0,a.a.createElement(at,{width:"540",height:"960",ref:this.canvasRef}),Ke(lt,{onClick:this.download}),Ke(st,{onClick:this.props.openEditor}))}}])&&Ze(r.prototype,n),o&&Ze(r,o),t}(n.PureComponent);r.d(t,"default",(function(){return ct}))},"6080a705f759d5ca199c":function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.d(t,"a",(function(){return a}));var a=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Object.entries(e).map((function(e){var t=n(e,2);return{key:t[0],stat:t[1]}}));a.sort((function(e,t){return e.stat>t.stat?-1:e.stat<t.stat?1:e.index<t.index?-1:e.index>t.index?1:0}));var o=a.map((function(e){return e.key})),i={hp:0,atk:0,spd:0,def:0,res:0};r&&t>0&&(i[o[0]]=1,i[o[1]]=1,i[o[2]]=1);for(var l=0;l<2*t;l+=1){var s=l%5;i[o[s]]+=1}return i}}}]);